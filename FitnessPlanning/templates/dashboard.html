{% extends 'base.html' %}
{% block content %}

<div class="dashboard-container">

  <div class="section">
    <div class="half">
      {% if window_status %}
        <h4>{{ window_status }} </h4> 
      {% endif %}
      <h3>Fasting Schedule for the Week</h3>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Time</th>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th>
            <th>Friday</th>
            <th>Saturday</th>
            <th>Sunday</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>00:00 - 06:00</strong></td>
            <td>{{ fasting_result.monday_00_06 }}</td>
            <td>{{ fasting_result.tuesday_00_06 }}</td>
            <td>{{ fasting_result.wednesday_00_06 }}</td>
            <td>{{ fasting_result.thursday_00_06 }}</td>
            <td>{{ fasting_result.friday_00_06 }}</td>
            <td>{{ fasting_result.saturday_00_06 }}</td>
            <td>{{ fasting_result.sunday_00_06 }}</td>
          </tr>
          <tr>
            <td><strong>06:00 - 12:00</strong></td>
            <td>{{ fasting_result.monday_06_12 }}</td>
            <td>{{ fasting_result.tuesday_06_12 }}</td>
            <td>{{ fasting_result.wednesday_06_12 }}</td>
            <td>{{ fasting_result.thursday_06_12 }}</td>
            <td>{{ fasting_result.friday_06_12 }}</td>
            <td>{{ fasting_result.saturday_06_12 }}</td>
            <td>{{ fasting_result.sunday_06_12 }}</td>
          </tr>
          <tr>
            <td><strong>12:00 - 18:00</strong></td>
            <td>{{ fasting_result.monday_12_18 }}</td>
            <td>{{ fasting_result.tuesday_12_18 }}</td>
            <td>{{ fasting_result.wednesday_12_18 }}</td>
            <td>{{ fasting_result.thursday_12_18 }}</td>
            <td>{{ fasting_result.friday_12_18 }}</td>
            <td>{{ fasting_result.saturday_12_18 }}</td>
            <td>{{ fasting_result.sunday_12_18 }}</td>
          </tr>
          <tr>
            <td><strong>18:00 - 24:00</strong></td>
            <td>{{ fasting_result.monday_18_24 }}</td>
            <td>{{ fasting_result.tuesday_18_24 }}</td>
            <td>{{ fasting_result.wednesday_18_24 }}</td>
            <td>{{ fasting_result.thursday_18_24 }}</td>
            <td>{{ fasting_result.friday_18_24 }}</td>
            <td>{{ fasting_result.saturday_18_24 }}</td>
            <td>{{ fasting_result.sunday_18_24 }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="half">
      <h3>Edit Fasting Schedule</h3>
      <form method="post">
        {% csrf_token %}
        {{ fasting_form.as_p }}
        <button type="submit" name="fasting-submit">Save Fasting Schedule</button>
      </form>
    </div>
  </div>

  <div class="section">
    <div class="half">
      <h2>Exercise Recommendation</h2>
      <form method="post">
        {% csrf_token %}
        {{ exercise_form.as_p }}
        <button type="submit" name="exercise-submit">Save Exercise</button>
      </form>

      {% if exercise_result %}
        <hr>
        <h3>Recommendation</h3>
        <p><strong>Exercise Type:</strong> {{ exercise_result.exercise_type }}</p>
        <p><strong>Recommended Exercise:</strong> {{ exercise_result.recommended_exercise }}</p>
        <p><strong>Calories Burned:</strong> {{ exercise_result.calories_burned }}</p>
        <p><strong>Duration:</strong> {{ exercise_result.duration }}</p>
      {% endif %}

      <!-- <h4>Previous Exercise Entries</h4>
      <ul>
        {% for entry in exercise_entries %}
          <li>{{ entry.recommended_exercise }} — {{ entry.duration }} — {{ entry.calories_burned }} kcal</li>
        {% empty %}
          <li>No previous exercise recommendations.</li>
        {% endfor %}
      </ul> -->
    </div>

    <div class="half">
      <h2>Calorie Deficit Planner</h2>
      <form method="post">
        {% csrf_token %}
        {{ deficit_form.as_p }}
        <button type="submit" name="deficit-submit">Save Caloric Plan</button>
      </form>

      {% if deficit_result %}
        <hr>
        <h3>Plan Summary</h3>
        <p><strong>Current Weight:</strong> {{ deficit_result.current_weight }} kg</p>
        <p><strong>Target Weight:</strong> {{ deficit_result.target_weight }} kg</p>
        <p><strong>Goal Date:</strong> {{ deficit_result.target_date }}</p>
        <p><strong>Recommended Daily Caloric Intake:</strong> {{ deficit_result.daily_caloric_intake }} kcal/day</p>
      {% endif %}

      <!-- <h4>Previous Calorie Plans</h4>
      <ul>
        {% for entry in deficit_entries %}
          <li>
            {{ entry.start_date }}: {{ entry.current_weight }} kg → {{ entry.target_weight }} kg by {{ entry.target_date }}  
            — {{ entry.daily_caloric_intake }} kcal/day
          </li>
        {% empty %}
          <li>No previous plans.</li>
        {% endfor %} -->
      <!-- </ul> -->
    </div>
  </div>
</div>

{% endblock %}
